<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OPSLOTOS</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="wrapper">

    <!-- Fejléc -->
    <header>
      <div class="brand">
        <span class="logo-dot"></span> OPSLOTOS
      </div>
      <div class="actions">
        <label class="search">
          <input type="search" id="q" placeholder="Keresés név vagy leírás alapján" />
        </label>
      </div>
    </header>

    <!-- Kaszinó kártyák rácsa -->
    <div class="grid" id="casinoGrid"></div>

  </div>

  <!-- Lábléc -->
  <footer>
    <a href="https://discord.gg/r8WmvpbH" target="_blank" class="discord-btn">
      <svg class="discord-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 245 240">
        <path fill="currentColor" d="M104.4 104.5c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.3-5 10.2-11.1.1-6.1-4.5-11.1-10.2-11.1zm36.2 0c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.3-5 10.2-11.1.1-6.1-4.5-11.1-10.2-11.1z"/>
        <path fill="currentColor" d="M189.5 20h-134C39 20 26 33 26 49.5v141c0 16.5 13 29.5 29.5 29.5h114.3l-5.4-18.8 13 12 12 11 21.3 19V49.5c0-16.5-13-29.5-29.5-29.5zM163 155s-4.6-5.5-8.4-10.3c16.7-4.7 23-15.3 23-15.3-5.2 3.3-10.1 5.7-14.5 7.3-6.3 2.7-12.3 4.4-18.2 5.4-12 2.2-23 1.6-32.5-.1-7.1-1.3-13.2-3.1-18.2-5.4-2.8-1.1-5.9-2.5-9.1-4.3-.4-.3-.8-.5-1.2-.8-.3-.2-.5-.3-.7-.5-.3-.2-.4-.3-.4-.3s6.1 10.2 22.3 15c-3.8 4.8-8.5 10.6-8.5 10.6-28.1-.9-38.8-19.2-38.8-19.2 0-40.6 18.2-73.6 18.2-73.6 18.2-13.6 35.5-13.2 35.5-13.2l1.3 1.6c-22.8 6.5-33.3 16.5-33.3 16.5s2.8-1.6 7.5-3.8c13.7-6 24.6-7.6 29.1-8 0.8-.1 1.5-.2 2.3-.2 8.2-1.1 17.4-1.4 27 0.1 12.7 1.9 26.4 6.6 40.4 16.2 0 0-9.9-9.4-31.2-15.8l1.8-2s17.3-.4 35.5 13.2c0 0 18.2 33 18.2 73.6 0 .1-10.8 18.4-39 19.3z"/>
      </svg>
      Discord
    </a>
    <p class="footer-text">© 2025 OPSLOTOS – Minden jog fenntartva</p>
  </footer>

  <!-- Script -->
  <script>
    // A saját Google Sheet azonosítód
    const SHEET_ID = "1O0xfpBB1UBMqdurq9R7rN4G7zBqiFs7bRhvpmDrfDdY";

    const grid = document.getElementById("casinoGrid");
    const q = document.getElementById("q");

    // Állapot kijelző
    const statusEl = document.createElement("div");
    statusEl.id = "status";
    statusEl.style.textAlign = "center";
    statusEl.style.margin = "16px 0";
    statusEl.style.color = "#b7b7b7";
    statusEl.textContent = "Betöltés…";
    grid.after(statusEl);

    // Google Sheets beolvasása
    async function loadCasinos() {
      try {
        const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;
        const res = await fetch(url);
        const text = await res.text();
        const json = JSON.parse(text.substring(47, text.length - 2));
        const rows = json?.table?.rows || [];

        grid.innerHTML = "";

        // Első sor kihagyása (fejléc)
        const dataRows = rows.slice(1);

        dataRows.forEach((r) => {
          const [name, description, image, link] = (r.c || []).map(c => (c ? c.v : ""));
          if (!name || !link) return;

          grid.insertAdjacentHTML(
            "beforeend",
            `
            <a class="card" href="${link}" target="_blank">
              <div class="media">
                <img src="${image || ""}" alt="${name} logó" loading="lazy" decoding="async">
              </div>
              <div class="content">
                <div class="title">${name}</div>
                <div class="desc">${description || ""}</div>
              </div>
            </a>
          `
          );
        });

        if (!grid.children.length) {
          statusEl.textContent = "Nincs megjeleníthető kaszinó.";
        } else {
          statusEl.remove();
        }
      } catch (err) {
        console.error("Hiba a Sheet beolvasásakor:", err);
        statusEl.textContent = "❌ Hiba: nem sikerült beolvasni a táblázatot.";
      }
    }

    // Kereső
    function wireSearch() {
      q?.addEventListener("input", () => {
        const t = q.value.trim().toLowerCase();
        grid.querySelectorAll(".card").forEach((card) => {
          const text = card.textContent.toLowerCase();
          card.classList.toggle("hidden", t && !text.includes(t));
        });
      });
    }

    // Indítás
    document.addEventListener("DOMContentLoaded", () => {
      wireSearch();
      loadCasinos();
    });
  </script>

</body>
</html>

